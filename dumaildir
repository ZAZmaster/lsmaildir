#!/bin/bash

##########################################################################################
#Данный сценарий преобразует имена русскоязычных директорий MAILDIR, в человекочитаемые,
#выводя сравнительную таблицу нормальных имён файлов и оригинальных.
##########################################################################################

#Создаём функцию преобразования.
dumaildir() {

#Создаём временный файл и заносим в переменную duofcurrentdir путь к этому файлу.
duofcurrentdir=$(mktemp)

#Заносим во временный файл листинг директории.
du -hd 1 "$@" > $duofcurrentdir

#Преобразуем листинг директории в человекочитаемый вид. Выстраиваем таблицу соотвествия оригинальных имён файлов и конвертированных.
du -hd 1 "$@" | sed -e 's:&:+:g' -e 's:,:/:g' -e 's:++:+-+:g' | iconv -f UTF7 -t UTF8 | paste - $duofcurrentdir | column -s $'\t' -t

#Удаляем созданный временный файл.
rm -f $duofcurrentdir

}

#Если в качестве аргумента к скрипту указано -h или --help - вывести справку. Если что-либо другое, или аргумента нет вообще - выполнять функцию dumaildir.
case "$@" in
        -h | --help)printf "Данный сценарий преобразует русскоязычные имена директорий MAILDIR, в человекочитаемые, \
выводя сравнительную таблицу нормальных имён файлов и оригинальных.\n";;
        *) dumaildir "$@";;
        esac
